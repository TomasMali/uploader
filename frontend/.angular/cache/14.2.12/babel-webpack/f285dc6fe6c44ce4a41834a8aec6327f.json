{"ast":null,"code":"import { HttpEventType, HttpResponse } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/file-upload.service\";\nimport * as i2 from \"@angular/common\";\n\nconst _c0 = function (a0) {\n  return {\n    width: a0\n  };\n};\n\nfunction FileUploadComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"div\", 11);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(3, _c0, ctx_r0.progress + \"%\"));\n    i0.ɵɵattribute(\"aria-valuenow\", ctx_r0.progress);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.progress, \"% \");\n  }\n}\n\nfunction FileUploadComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.message, \"\\n\");\n  }\n}\n\nfunction FileUploadComponent_tr_23_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\")(2, \"a\", 13);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"td\")(5, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function FileUploadComponent_tr_23_Template_button_click_5_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const file_r3 = restoredCtx.$implicit;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.delete(file_r3.name));\n    });\n    i0.ɵɵtext(6, \"Delete\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵpipe(12, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"td\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const file_r3 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"href\", file_r3.url, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(file_r3.name);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(9, 5, file_r3.createdAt));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(12, 7, file_r3.updatedAt));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(file_r3.size);\n  }\n}\n\nexport class FileUploadComponent {\n  constructor(uploadService) {\n    this.uploadService = uploadService;\n    this.progress = 0;\n    this.message = '';\n  }\n\n  ngOnInit() {\n    this.fileInfos = this.uploadService.getFiles();\n  }\n\n  selectFile(event) {\n    this.selectedFiles = event.target.files;\n  }\n\n  delete(file) {\n    this.uploadService.delete(file).subscribe({\n      next: event => {\n        if (event.type === HttpEventType.UploadProgress) {\n          this.progress = Math.round(100 * event.loaded / event.total);\n        } else if (event instanceof HttpResponse) {\n          this.message = event.body.message;\n          this.fileInfos = this.uploadService.getFiles();\n        }\n      },\n      error: err => {\n        console.log(err);\n        this.progress = 0;\n\n        if (err.error && err.error.message) {\n          this.message = err.error.message;\n        } else {\n          this.message = 'Could not delete the file!';\n        }\n\n        this.currentFile = undefined;\n      }\n    });\n  }\n\n  upload() {\n    this.progress = 0;\n\n    if (this.selectedFiles) {\n      const file = this.selectedFiles.item(0);\n\n      if (file) {\n        this.currentFile = file;\n        this.uploadService.upload(this.currentFile).subscribe({\n          next: event => {\n            if (event.type === HttpEventType.UploadProgress) {\n              this.progress = Math.round(100 * event.loaded / event.total);\n            } else if (event instanceof HttpResponse) {\n              this.message = event.body.message;\n              this.fileInfos = this.uploadService.getFiles();\n            }\n          },\n          error: err => {\n            console.log(err);\n            this.progress = 0;\n\n            if (err.error && err.error.message) {\n              this.message = err.error.message;\n            } else {\n              this.message = 'Could not upload the file!';\n            }\n\n            this.currentFile = undefined;\n          }\n        });\n      }\n\n      this.selectedFiles = undefined;\n    }\n  }\n\n}\n\nFileUploadComponent.ɵfac = function FileUploadComponent_Factory(t) {\n  return new (t || FileUploadComponent)(i0.ɵɵdirectiveInject(i1.FileUploadService));\n};\n\nFileUploadComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: FileUploadComponent,\n  selectors: [[\"app-file-upload\"]],\n  decls: 25,\n  vars: 6,\n  consts: [[1, \"row\", \"mb-4\", 2, \"margin-top\", \"100px\"], [1, \"col-8\"], [1, \"btn\", \"btn-default\", \"p-0\"], [\"type\", \"file\", 3, \"change\"], [1, \"col-4\"], [1, \"btn\", \"btn-success\", \"btn-sm\", 3, \"disabled\", \"click\"], [\"class\", \"progress my-3\", 4, \"ngIf\"], [\"class\", \"alert alert-secondary\", \"role\", \"alert\", 4, \"ngIf\"], [1, \"table\", \"table-striped\"], [4, \"ngFor\", \"ngForOf\"], [1, \"progress\", \"my-3\"], [\"role\", \"progressbar\", \"aria-valuemin\", \"0\", \"aria-valuemax\", \"100\", 1, \"progress-bar\", \"progress-bar-info\", 3, \"ngStyle\"], [\"role\", \"alert\", 1, \"alert\", \"alert-secondary\"], [3, \"href\"], [\"type\", \"button\", 1, \"btn\", \"btn-sm\", \"btn-danger\", 3, \"click\"]],\n  template: function FileUploadComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"label\", 2)(3, \"input\", 3);\n      i0.ɵɵlistener(\"change\", function FileUploadComponent_Template_input_change_3_listener($event) {\n        return ctx.selectFile($event);\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(4, \"div\", 4)(5, \"button\", 5);\n      i0.ɵɵlistener(\"click\", function FileUploadComponent_Template_button_click_5_listener() {\n        return ctx.upload();\n      });\n      i0.ɵɵtext(6, \" Upload \");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵtemplate(7, FileUploadComponent_div_7_Template, 3, 5, \"div\", 6);\n      i0.ɵɵtemplate(8, FileUploadComponent_div_8_Template, 2, 1, \"div\", 7);\n      i0.ɵɵelementStart(9, \"table\", 8)(10, \"thead\")(11, \"tr\")(12, \"th\");\n      i0.ɵɵtext(13, \"File Name\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(14, \"th\");\n      i0.ɵɵtext(15, \"Actions\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(16, \"th\");\n      i0.ɵɵtext(17, \"Created At\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(18, \"th\");\n      i0.ɵɵtext(19, \"Updated At\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"th\");\n      i0.ɵɵtext(21, \"File Size\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(22, \"tbody\");\n      i0.ɵɵtemplate(23, FileUploadComponent_tr_23_Template, 15, 9, \"tr\", 9);\n      i0.ɵɵpipe(24, \"async\");\n      i0.ɵɵelementEnd()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"disabled\", !ctx.selectedFiles);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.currentFile);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.message);\n      i0.ɵɵadvance(15);\n      i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(24, 4, ctx.fileInfos));\n    }\n  },\n  dependencies: [i2.NgForOf, i2.NgIf, i2.NgStyle, i2.AsyncPipe, i2.DatePipe],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJmaWxlLXVwbG9hZC5jb21wb25lbnQuY3NzIn0= */\"]\n});","map":{"version":3,"mappings":"AACA,SAASA,aAAT,EAAwBC,YAAxB,QAA4C,sBAA5C;;;;;;;;;;;;;ICiBAC,gCAA+C,CAA/C,EAA+C,KAA/C,EAA+C,EAA/C;IASIA;IACFA;;;;;IAHEA;IAAAA;IAHAA;IAKAA;IAAAA;;;;;;IAIJA;IACEA;IACFA;;;;;IADEA;IAAAA;;;;;;;;IAyBEA,2BAA2C,CAA3C,EAA2C,IAA3C,EAA2C,CAA3C,EAA2C,GAA3C,EAA2C,EAA3C;IAC+BA;IAAeA;IAC5CA,2BAAI,CAAJ,EAAI,QAAJ,EAAI,EAAJ;IACUA;MAAA;MAAA;MAAA;MAAA,OAASA,2CAAT;IAA0B,CAA1B;IAAwEA;IAAMA;IAExFA;IAAIA;;IAA2BA;IAC/BA;IAAIA;;IAA2BA;IAC/BA;IAAIA;IAAeA;;;;;IANZA;IAAAA;IAAsBA;IAAAA;IAIzBA;IAAAA;IACAA;IAAAA;IACAA;IAAAA;;;;ADtDV,OAAM,MAAOC,mBAAP,CAA0B;EAQ9BC,YAAoBC,aAApB,EAAoD;IAAhC;IALpB,gBAAW,CAAX;IACA,eAAU,EAAV;EAIwD;;EAExDC,QAAQ;IACN,KAAKC,SAAL,GAAiB,KAAKF,aAAL,CAAmBG,QAAnB,EAAjB;EAID;;EAEDC,UAAU,CAACC,KAAD,EAAW;IACnB,KAAKC,aAAL,GAAqBD,KAAK,CAACE,MAAN,CAAaC,KAAlC;EACD;;EAGDC,MAAM,CAACC,IAAD,EAAa;IACjB,KAAKV,aAAL,CAAmBS,MAAnB,CAA0BC,IAA1B,EAAgCC,SAAhC,CAA0C;MACxCC,IAAI,EAAGP,KAAD,IAAe;QACnB,IAAIA,KAAK,CAACQ,IAAN,KAAelB,aAAa,CAACmB,cAAjC,EAAiD;UAC/C,KAAKC,QAAL,GAAgBC,IAAI,CAACC,KAAL,CAAY,MAAMZ,KAAK,CAACa,MAAb,GAAuBb,KAAK,CAACc,KAAxC,CAAhB;QACD,CAFD,MAEO,IAAId,KAAK,YAAYT,YAArB,EAAmC;UACxC,KAAKwB,OAAL,GAAef,KAAK,CAACgB,IAAN,CAAWD,OAA1B;UACA,KAAKlB,SAAL,GAAiB,KAAKF,aAAL,CAAmBG,QAAnB,EAAjB;QACD;MACF,CARuC;MASxCmB,KAAK,EAAGC,GAAD,IAAa;QAClBC,OAAO,CAACC,GAAR,CAAYF,GAAZ;QACA,KAAKR,QAAL,GAAgB,CAAhB;;QAEA,IAAIQ,GAAG,CAACD,KAAJ,IAAaC,GAAG,CAACD,KAAJ,CAAUF,OAA3B,EAAoC;UAClC,KAAKA,OAAL,GAAeG,GAAG,CAACD,KAAJ,CAAUF,OAAzB;QACD,CAFD,MAEO;UACL,KAAKA,OAAL,GAAe,4BAAf;QACD;;QACD,KAAKM,WAAL,GAAmBC,SAAnB;MACD;IAnBuC,CAA1C;EAqBD;;EAEDC,MAAM;IACJ,KAAKb,QAAL,GAAgB,CAAhB;;IAEA,IAAI,KAAKT,aAAT,EAAwB;MACtB,MAAMI,IAAI,GAAgB,KAAKJ,aAAL,CAAmBuB,IAAnB,CAAwB,CAAxB,CAA1B;;MAEA,IAAInB,IAAJ,EAAU;QACR,KAAKgB,WAAL,GAAmBhB,IAAnB;QAEA,KAAKV,aAAL,CAAmB4B,MAAnB,CAA0B,KAAKF,WAA/B,EAA4Cf,SAA5C,CAAsD;UACpDC,IAAI,EAAGP,KAAD,IAAe;YACnB,IAAIA,KAAK,CAACQ,IAAN,KAAelB,aAAa,CAACmB,cAAjC,EAAiD;cAC/C,KAAKC,QAAL,GAAgBC,IAAI,CAACC,KAAL,CAAY,MAAMZ,KAAK,CAACa,MAAb,GAAuBb,KAAK,CAACc,KAAxC,CAAhB;YACD,CAFD,MAEO,IAAId,KAAK,YAAYT,YAArB,EAAmC;cACxC,KAAKwB,OAAL,GAAef,KAAK,CAACgB,IAAN,CAAWD,OAA1B;cACA,KAAKlB,SAAL,GAAiB,KAAKF,aAAL,CAAmBG,QAAnB,EAAjB;YACD;UACF,CARmD;UASpDmB,KAAK,EAAGC,GAAD,IAAa;YAClBC,OAAO,CAACC,GAAR,CAAYF,GAAZ;YACA,KAAKR,QAAL,GAAgB,CAAhB;;YAEA,IAAIQ,GAAG,CAACD,KAAJ,IAAaC,GAAG,CAACD,KAAJ,CAAUF,OAA3B,EAAoC;cAClC,KAAKA,OAAL,GAAeG,GAAG,CAACD,KAAJ,CAAUF,OAAzB;YACD,CAFD,MAEO;cACL,KAAKA,OAAL,GAAe,4BAAf;YACD;;YAED,KAAKM,WAAL,GAAmBC,SAAnB;UACD;QApBmD,CAAtD;MAsBD;;MAED,KAAKrB,aAAL,GAAqBqB,SAArB;IACD;EACF;;AAjF6B;;;mBAAnB7B,qBAAmBD;AAAA;;;QAAnBC;EAAmBgC;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCVhCrC,+BAAiD,CAAjD,EAAiD,KAAjD,EAAiD,CAAjD,EAAiD,CAAjD,EAAiD,OAAjD,EAAiD,CAAjD,EAAiD,CAAjD,EAAiD,OAAjD,EAAiD,CAAjD;MAG0BA;QAAA,OAAUsC,sBAAV;MAA4B,CAA5B;MAApBtC;MAIJA,+BAAmB,CAAnB,EAAmB,QAAnB,EAAmB,CAAnB;MAIIA;QAAA,OAASsC,YAAT;MAAiB,CAAjB;MAEAtC;MACFA;MAIJA;MAaAA;MAeAA,iCAAmC,EAAnC,EAAmC,OAAnC,EAAmC,EAAnC,EAAmC,IAAnC,EAAmC,EAAnC,EAAmC,IAAnC;MAGUA;MAASA;MACbA;MAAIA;MAAOA;MACXA;MAAIA;MAAUA;MACdA;MAAIA;MAAUA;MACdA;MAAIA;MAASA;MAGjBA;MACEA;;MASFA;;;;MAxDIA;MAAAA;MAQAA;MAAAA;MAaAA;MAAAA;MA0BmBA;MAAAA","names":["HttpEventType","HttpResponse","i0","FileUploadComponent","constructor","uploadService","ngOnInit","fileInfos","getFiles","selectFile","event","selectedFiles","target","files","delete","file","subscribe","next","type","UploadProgress","progress","Math","round","loaded","total","message","body","error","err","console","log","currentFile","undefined","upload","item","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["/Users/tommal/Desktop/uploader/frontend/src/app/components/file-upload/file-upload.component.ts","/Users/tommal/Desktop/uploader/frontend/src/app/components/file-upload/file-upload.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { HttpEventType, HttpResponse } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { FileUploadService } from 'src/app/services/file-upload.service';\n\n@Component({\n  selector: 'app-file-upload',\n  templateUrl: './file-upload.component.html',\n  styleUrls: ['./file-upload.component.css']\n})\nexport class FileUploadComponent implements OnInit {\n  selectedFiles?: FileList;\n  currentFile?: File;\n  progress = 0;\n  message = '';\n\n  fileInfos?: Observable<any>;\n\n  constructor(private uploadService: FileUploadService) {}\n\n  ngOnInit(): void {\n    this.fileInfos = this.uploadService.getFiles();\n\n\n   \n  }\n\n  selectFile(event: any): void {\n    this.selectedFiles = event.target.files;\n  }\n\n\n  delete(file: string): void {\n    this.uploadService.delete(file).subscribe({\n      next: (event: any) => {\n        if (event.type === HttpEventType.UploadProgress) {\n          this.progress = Math.round((100 * event.loaded) / event.total);\n        } else if (event instanceof HttpResponse) {\n          this.message = event.body.message;\n          this.fileInfos = this.uploadService.getFiles();\n        }\n      },\n      error: (err: any) => {\n        console.log(err);\n        this.progress = 0;\n\n        if (err.error && err.error.message) {\n          this.message = err.error.message;\n        } else {\n          this.message = 'Could not delete the file!';\n        }\n        this.currentFile = undefined;\n      },\n    });\n  }\n\n  upload(): void {\n    this.progress = 0;\n\n    if (this.selectedFiles) {\n      const file: File | null = this.selectedFiles.item(0);\n\n      if (file) {\n        this.currentFile = file;\n\n        this.uploadService.upload(this.currentFile).subscribe({\n          next: (event: any) => {\n            if (event.type === HttpEventType.UploadProgress) {\n              this.progress = Math.round((100 * event.loaded) / event.total);\n            } else if (event instanceof HttpResponse) {\n              this.message = event.body.message;\n              this.fileInfos = this.uploadService.getFiles();\n            }\n          },\n          error: (err: any) => {\n            console.log(err);\n            this.progress = 0;\n\n            if (err.error && err.error.message) {\n              this.message = err.error.message;\n            } else {\n              this.message = 'Could not upload the file!';\n            }\n\n            this.currentFile = undefined;\n          },\n        });\n      }\n\n      this.selectedFiles = undefined;\n    }\n  }\n}\n","<div class=\"row mb-4\" style=\"margin-top: 100px;\">\n  <div class=\"col-8\">\n    <label class=\"btn btn-default p-0\">\n      <input  type=\"file\" (change)=\"selectFile($event)\" />\n    </label>\n  </div>\n\n  <div class=\"col-4\">\n    <button\n      class=\"btn btn-success btn-sm\"\n      [disabled]=\"!selectedFiles\"\n      (click)=\"upload()\"\n    >\n      Upload\n    </button>\n  </div>\n</div>\n\n<div *ngIf=\"currentFile\" class=\"progress my-3\">\n  <div\n    class=\"progress-bar progress-bar-info\"\n    role=\"progressbar\"\n    attr.aria-valuenow=\"{{ progress }}\"\n    aria-valuemin=\"0\"\n    aria-valuemax=\"100\"\n    [ngStyle]=\"{ width: progress + '%' }\"\n  >\n    {{ progress }}%\n  </div>\n</div>\n\n<div *ngIf=\"message\" class=\"alert alert-secondary\" role=\"alert\">\n  {{ message }}\n</div>\n\n<!-- <div class=\"card mt-3\">\n  <div class=\"card-header\">List of Files</div>\n  <ul class=\"list-group list-group-flush\">\n    <li *ngFor=\"let file of fileInfos | async\" class=\"list-group-item\">\n      <a href=\"{{ file.url }}\">{{ file.name }}</a>   <button (click)=\"delete(file.name )\" type=\"button\" class=\"btn btn-sm btn-danger ml-5\">Delete</button>  createdAt -  {{ file.createdAt | date }}\n      updatedAt -  {{ file.updatedAt | date }}    size -  {{ file.size }}\n    </li>\n  </ul>\n</div> -->\n\n\n<table class=\"table table-striped\">\n  <thead>\n    <tr>\n      <th>File Name</th>\n      <th>Actions</th>\n      <th>Created At</th>\n      <th>Updated At</th>\n      <th>File Size</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr *ngFor=\"let file of fileInfos | async\">\n      <td><a href=\"{{ file.url }}\">{{ file.name }}</a></td>\n      <td>\n        <button (click)=\"delete(file.name)\" type=\"button\" class=\"btn btn-sm btn-danger\">Delete</button>\n      </td>\n      <td>{{ file.createdAt | date }}</td>\n      <td>{{ file.updatedAt | date }}</td>\n      <td>{{ file.size }}</td>\n    </tr>\n  </tbody>\n</table>\n"]},"metadata":{},"sourceType":"module"}